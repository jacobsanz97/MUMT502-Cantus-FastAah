<!DOCTYPE html>

<html>

<head>
	<title>Javascript MIDI Player</title>
	<script src='libraries/WebAudioFontPlayer.js'></script>
    <script src='libraries/MIDIFile.js'></script>
    <script src='libraries/MIDIPlayer.js'></script>

</head>

<body>



	<h2>Javascript MIDI Player</h2>
	<div id='cntls'>
		<p>
			<input type="file" id="filesinput" name="filesarr[]" accept=".mid,.midi,.kar"/>
			<button type="button" onclick="player.play()">Play</button>
			<button type="button" onclick="player.pause()">Pause</button>
            <button type="button" onclick="player.stop()">Stop</button>
            <input id="position" type="range" min="0" max="100" value="0">
            

            
		</p>
	</div>
	<script>
    
	    // create the player object using a file input by id or DOM Element
	    player=new MIDIPlayer('filesinput');

	    // register the onload function to start playing
	    player.onload = function(song){
		    player.play();
		    var pos= document.getElementById("position");
	    	pos.setAttribute("max",song.duration);
    	}

	    // the tick event is triggered in every position change
	    player.ontick=function(song,position){
	    	var pos= document.getElementById("position");
	    	pos.value=position;
	    }


	//	var AudioContextFunc = window.AudioContext || window.webkitAudioContext;		
	//	var audioContext = new AudioContextFunc();
    //    var channelMaster = player.createChannel(audioContext);		
    //    var reverberator = player.createReverberator(audioContext);
	//	channelMaster.output.connect(reverberator.input);
	//	reverberator.output.connect(audioContext.destination);

    // probably control the tempo and the reverb inside the libraries js
    // or at least control them inside the song,position for when the tick is triggered (eg vol)
    
	</script>
</body>

</html>